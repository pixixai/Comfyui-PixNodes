# JSON 对象提取

这是一个专为处理复杂 JSON 数据和 LLM（大语言模型）输出设计的智能提取节点。它不仅能精确提取字段，还能自动修复语法错误、过滤废话，并支持强大的模糊匹配与正则回退机制。V2.6 版本引入了深度词干匹配与原生数据输出支持。

## 核心功能

1. **所见即所得的动态端口**
    - 采用 **多行文本框 (`match_keys`)** 直接定义输出。
    - 修改文本后，输出端口会实时增加或减少（最多支持 100 个）。
2. **归一化模糊匹配 (Normalized Fuzzy Match)**
    - **智能匹配**：忽略大小写、下划线、中划线和空格。
    - **示例**：`"User_Name": "Alice"` -> 匹配键 `user name` 即可提取。
    - **深度词干匹配 (Deep Stemmed Match)** (V2.6 新增)：
        - **痛点解决**：专门解决单词中间或结尾出现复数导致匹配失败的问题。
        - **机制**：算法会将 Key 拆分为独立单词，去除每个单词末尾的 `s` 后再重组比对。
        - **示例**：输入 `shot_prompt` 可完美匹配 JSON 中的 `shots_prompts`、`shot_prompts` 或 `shots_prompt`。
3. **LLM 强力容错 (Regex Fallback)**
    - 当 JSON 格式彻底损坏时，自动启动 **正则暴力匹配模式**，尝试从文本中直接提取数据。
4. **灵活的输出模式 (Native Output)**
    - **分离模式（默认）**：
        - **原生输出逻辑**：
            - **值是对象** (`{...}`) -> 直接输出对象。
            - **值是数组** (`[...]`) -> 直接输出数组。
            - **值是单值** (`"abc"`, `123`, `true`) -> 包裹在数组中输出（例如 `["abc"]`）。
            - **值为空** -> 输出空数组 `[]`。
        - **不再强制封装**：V2.5 版本移除了 `{"content": ...}` 强制封装，使数据更易于被其他通用 JSON 节点处理。
    - **合并模式 (Merge Output)**：
        - 开启 `merge_output` 后，输出端口合并为 1 个。
        - 输出一个纯净的 JSON 对象，包含所有提取到的字段，**完全保留原始数据结构**。

## 参数说明

- **json_input (STRING)**
    - 原始的 JSON 字符串或 LLM 生成的文本。
- **match_keys (STRING)**
    - **核心控制器**。在此输入想要提取的字段名，**每行一个**。
- **merge_output (BOOLEAN)**
    - **Enable**: 合并模式。输出单一对象 `{ key1: val1, key2: val2 }`。
    - **Disable**: 分离模式。多端口输出，根据值类型自动判断输出结构。

## 常见问题

**Q: 为什么以前输出有 `content` 字段，现在没有了？**
A: V2.5 版本为了提高通用性，去除了强制封装。现在的输出是“原汁原味”的：如果是字符串就给你字符串列表，如果是对象就给你对象。

**Q: 提取字符串时，为什么被放在数组里了？**
A: 为了保证输出格式的统一性和容错性（例如方便后续节点进行批处理），单个值会被默认放入数组中（如 `["my string"]`）。如果提取到的是真正的数组，则直接输出该数组。

**Q: 为什么输入 `key` 能匹配到 `keys`？**
A: 这是归一化匹配在起作用。V2.6 版本增强了这一功能，甚至 `key_list` 也能匹配 `keys_lists`。