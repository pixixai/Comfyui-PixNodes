# 🎞️ 网格分镜提示词

此节点专为生成结构化、具有空间方位引导的分镜提示词而设计。它能够将分散的风格、场景、主体和具体分镜内容有机组合，生成一段能够指引 AI 模型（如 Flux, SDXL, NanoBananaPro 等）准确绘制网格布局的全局提示词。

## 核心功能

- **智能网格引导**：自动根据选择的网格规模（2x2, 3x3, 4x4）生成对应的方位描述（如“左上”、“第 1 行，第 2 列”）。
- **多格式兼容性**：支持解析标准的 JSON 字符串列表、包含特定键值的对象数组，以及纯文本描述。
- **一致性增强**：在生成的 Prompt 头部强制加入视觉一致性指令，确保所有面板在风格、光影和角色上保持统一。
- **动态排版**：自动隐藏未输入内容的板块，确保生成的提示词结构紧凑、无多余空行。

## 参数说明

### 输入参数 (Inputs)

- **style (艺术风格)**:
    - 定义全局的视觉风格（如：赛璐璐、写实照片、3D 渲染）。
    - 会被放置在“整体美学画风”板块。
- **scene (环境细节)**:
    - 描述背景空间、天气、灯光氛围。
    - 会被放置在“环境与灯光细节规范”板块。
- **subject (主体细节)**:
    - 描述核心角色、服装、外观特征。
    - 会被放置在“主体/角色细节规范”板块。
- **shots (分镜内容)**:
    - 最核心的参数，描述每个网格面板具体发生的瞬间、动作或构图。
    - 支持解析 JSON 数组中的 `prompt` 键。
- **grid (网格规模)**:
    - 可选 `2x2` (4 面板), `3x3` (9 面板), `4x4` (16 面板)。
- **ratio (比例)**:
    - 设置生成的整体画布宽高比。

### 输出参数 (Outputs)

- **prompt (0)**:
    - 最终组合完成的结构化文本。

## 数据解析规则

针对 `style`, `scene`, `subject`, `shots` 接口，支持以下三种数据输入：

1. **纯文本**: 直接将输入的整段文字作为内容。
2. **纯数组**: `["内容1", "内容2"]`。
3. **对象数组**: `[{"prompt": "内容1"}, {"prompt": "内容2"}]`（对于 shots 接口）或 `[{"content": "内容1"}]`（对于其他接口）。

## 使用示例

输入的组合结果通常如下：

> 2x2 网格布局构图（单张图像内包含 4 个等大的分镜面板），总宽高比为 16:9。...
> 
> 
> 整体美学画风描述（所有面板保持一致）：
> 二次元赛璐璐风格，高对比度...
> 
> 面板分镜描述（作为一个整体图像阅读）：
> 分镜 1 (左上)：主角在森林中奔跑
> 分镜 2 (右上)：主角停下脚步喘气...
>