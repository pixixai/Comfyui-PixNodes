# JSON 解包

**JSON Unpacker** 是一个用于处理和格式化 JSON 数据的实用节点。它可以接收 JSON 字符串，将其内部结构“解包”并展平，去除所有的括号、引号和缩进，最终输出为纯文本字符串。

该节点针对 LLM（大型语言模型）输出进行了深度优化，具备强大的**自动修复**功能，并支持**无限层级**的自定义分隔符。

## 功能特性

- **智能修复与补全**：
    - **自动定位**：自动扫描文本中的 `{}` 或 `[]`，忽略前导废话。
    - **截断补全**：如果 LLM 输出被 Token 限制截断（例如只有左括号没有右括号），节点会自动分析结构并在末尾补全对应的 `}` 或 `]`。
    - **纯文本兼容**：如果输入完全没有 JSON 括号结构，会自动尝试按逗号切分或视为单行文本。
- **无限层级展平**：支持自定义任意深度的分隔符。
- **递归处理**：无论数据嵌套多少层，都会递归处理。
- **键值控制**：处理字典时可选择是否保留 Key。

## 输入参数说明

**json_data**
主要数据输入。通常连接 LLM 输出。

- 支持：标准 JSON、Python 字典/列表字符串、不完整的 JSON 片段、纯文本。

**delimiters (多级分隔符)**
这是一个多行文本框，用于定义不同嵌套层级的分隔符。

- **逻辑**：
    - **第 1 行**：对应 Level 1（最外层）元素之间的分隔符。
    - **第 2 行**：对应 Level 2（内部嵌套）元素之间的分隔符。
    - **第 N 行**：对应 Level N 元素之间的分隔符。
    - **兜底规则**：如果数据的嵌套深度超过了你提供的行数，将**重复使用最后一行**作为分隔符。
- **默认值**：
    
    ```
    \n   <-- 第一行：换行符
    ,    <-- 第二行：逗号
    
    ```
    
- **特殊字符**：支持 `\n` (换行) 和 `\t` (制表符)。

**keep_key (保留键名)**
控制处理字典（对象）时的格式。

- **False (默认)**：仅输出 Value。
- **True**：输出 `Key:Value`。

## 输出说明

**text**
处理完成后的纯文本字符串。

## 使用示例

**场景：处理多层嵌套列表**
输入：
`[[["A", "B"], "C"], "D"]`

**配置 delimiters**：

```
\n      (Level 1: 换行)
 ---    (Level 2: 虚线)
 &      (Level 3: 和号)

```

**处理逻辑**：

1. 最外层列表 `[..., "D"]` 使用第一行 `\n` 分隔。
2. 第二层列表 `[..., "C"]` 使用第二行 `--` 分隔。
3. 最内层列表 `["A", "B"]` 使用第三行 `&` 分隔。

**输出结果**：

```
A & B --- C
D

```