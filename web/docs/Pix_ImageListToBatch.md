# Image List to Batch (PixNodes)

此节点用于将多个图像（无论是单个张量还是图像列表）合并为一个标准化的图像批次（Image Batch）。它提供了强大的尺寸对齐功能，确保输出的批次具有统一的分辨率。

## 参数说明

### 输入 (Inputs)

- **image_list**: 图像输入插槽。支持连接多个图像或列表。
- **mode (模式)**:
    - `Fill` (默认): 图像完整填充满尺寸范围，超出部分会被裁切。
    - `Fit`: 图像在尺寸范围内全部显示，不被裁切，空白区域填充背景色。
    - `Stretch`: 图像被强制拉伸至目标尺寸。
- **alignment (中心点定位)**:
    - 决定图像在画布上的对齐位置（如：左上、中心、右下等）。在 `Fill` 模式下决定裁切起始点，在 `Fit` 模式下决定图像摆放位置。
- **background_color (背景颜色)**:
    - **类型**: `STRING` (文本框输入)。
    - **默认值**: `#FFFFFF` (白色)。
    - 用于 `Fit` 模式下的空白区域填充。
    - **支持的格式与优先级**（按解析顺序）：
        1. **列表/数组 (List/Tuple)**:
            - **RGB (Int)**: 如 `[255, 0, 0]` (红)。
            - **HSV (Float)**: 如 `[0.5, 1.0, 1.0]` (自动识别归一化或 360/100 标准)。
            - *支持 AST 解析*: 可以直接输入字符串格式的列表，如 `"[255, 0, 0]"`。
        2. **RGB 字符串**:
            - 增强兼容性，支持带括号或前缀，如 `rgb(255, 0, 0)`, `(255, 128, 0)`, `255,128,0`。
        3. **Hex 十六进制**:
            - **标准格式**: `#FF0000`, `0xFF0000`。
            - **无前缀 6 位**: `FF0000` (红)。
            - **纯数字 6 位 (特例)**: `888888` 会被优先识别为灰色 (Hex)，而不是十进制。
            - **8 位 Hex**: `#FF000080` (支持 RRGGBBAA，自动丢弃最后两位透明度)。
            - **容错支持**: 支持全角井号 `＃`, 双井号 `##`，自动忽略空格。
        4. **十进制整数**:
            - 任何**非 6 位**的纯数字字符串，如 `16711680` (红) 或 `16777215` (白)。
- **size (尺寸)**:
    - 格式如 `1920x1080` 或 `512`（宽高相同）。
    - **默认值为空**：如果留空，则自动以输入列表中的**第一张图**的尺寸作为基准，将后续所有图片对齐到该尺寸。

### 输出 (Outputs)

- **image_batch**: 合并并处理后的标准图像批次 Tensor `[B, H, W, C]`。

## 技术特性

- **智能颜色解析**:
    - 采用严格的正则匹配 (Anchors) 解决歧义。例如，虽然 `888888` 既是十进制也是 Hex，但本节点遵循设计软件习惯，将其优先视为 Hex 灰色。
    - 强大的容错性：自动清洗 RGB 字符串中的非数字字符，支持从 CSS 或其他代码中直接复制颜色值。
- **HSV 色彩支持**: 支持直接输入 HSV 浮点数组，节点会自动进行 Gamma 安全的色彩空间转换。
- **智能列表处理**: 使用 `INPUT_IS_LIST = True` 机制，自动解包和规范化输入的图像列表，无论输入是单个 Batch 还是 List 都能正确处理。
- **自动维度对齐**: 自动处理 Mask (1通道) 和 RGBA (4通道) 输入，统一转换为 RGB (3通道)。