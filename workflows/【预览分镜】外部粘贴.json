{"id":"999eeb32-b373-4b30-977e-5d175b7fa65c","revision":0,"last_node_id":23,"last_link_id":72,"nodes":[{"id":1,"type":"Pix_CreateImageBatch","pos":[19635.96664544198,21400.40633550911],"size":[576.4321199156293,400],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"批量宽度","name":"batch_width","type":"INT","widget":{"name":"batch_width"},"link":null},{"localized_name":"批量高度","name":"batch_height","type":"INT","widget":{"name":"batch_height"},"link":null},{"localized_name":"缩放模式","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"localized_name":"背景颜色","name":"bg_color","type":"STRING","widget":{"name":"bg_color"},"link":null}],"outputs":[{"localized_name":"图像批次","name":"image_batch","type":"IMAGE","links":[70]},{"localized_name":"图像列表","name":"image_list","shape":6,"type":"IMAGE","links":null}],"properties":{"cnr_id":"pixnodes","ver":"ee23206d344e47d8628302c0888e8039d346242a","Node name for S&R":"Pix_CreateImageBatch"},"widgets_values":[1920,1075,"fill","#000000","[]",""]},{"id":6,"type":"Pix_ColorPicker","pos":[19461.84794056839,22524.799128435356],"size":[240,400],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"输入模式 (Mode)","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"输出格式","name":"output_format","type":"COMBO","widget":{"name":"output_format"},"link":null},{"label":"Red","localized_name":"红色 / 色相 (R/H)","name":"red","type":"INT","widget":{"name":"red"},"link":null},{"label":"Green","localized_name":"绿色 / 饱和度 (G/S)","name":"green","type":"INT","widget":{"name":"green"},"link":null},{"label":"Blue","localized_name":"蓝色 / 明度 (B/V)","name":"blue","type":"INT","widget":{"name":"blue"},"link":null}],"outputs":[{"label":"RGB","localized_name":"动态输出","name":"RGB","type":"LIST","links":null}],"properties":{"cnr_id":"pixnodes","ver":"864463d637cbee3d4dc9d1b2457ac2eb83017733","Node name for S&R":"Pix_ColorPicker"},"widgets_values":["RGB","RGB (List)",21,204,89,""]},{"id":19,"type":"MarkdownNote","pos":[18431.674791280053,22368.404843902143],"size":[478.72724281567207,541.0648325144575],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"title":"把脚本转换为JSON的LLM系统提示词","properties":{},"widgets_values":["# Role: 分镜脚本对话转换专家\n\n## Context\n\n你是一个专门在对话环境中工作的分镜数据结构化专家。用户会向你发送“原始分镜脚本”，并列出一系列“提取字段”（如：分镜编号、景别、镜头内容、音效）。你的任务是将脚本内容按字段要求精准映射为标准 JSON 字符串。\n\n## Task\n\n1. **字段识别**：从用户对话中识别用户要求的字段列表。每一个字段都将作为最终输出 JSON 对象中的一个 Key。\n2. **精准映射**：将分镜脚本内容按镜头顺序拆解，根据每个字段的语义含义，从原文中提取对应信息。\n3. **动态生成 Key**：直接使用用户提供的字段名作为 Key。严禁擅自翻译、缩写或更改用户指定的字段名称。**同时，JSON 对象内部字段的物理排列顺序必须严格依照用户提供的先后顺序。**\n\n## 参考基准：逻辑说明\n\n用户会通过文字描述字段，例如：“包含‘分镜编号、景别、内容、时长、音效’”。 你的输出必须严格遵循如下标准的 JSON 缩进格式，并按如下逻辑填充内容：\n\n```\n[\n    {\n        \"分镜编号\": \"镜号（如：01）\",\n        \"景别\": \"景别（如：特写、全景等）\",\n        \"内容\": \"从文本提取对应本镜头的视觉内容描述\",\n        \"时长\": \"从文本提取的该镜头时长\",\n        \"音效\": \"音效、对白、旁白内容\"\n    },\n    {\n        \"分镜编号\": \"镜号（如：02）\",\n        \"景别\": \"景别（如：特写、全景等）\",\n        \"内容\": \"从文本提取对应本镜头的视觉内容描述\",\n        \"时长\": \"从文本提取的该镜头时长\",\n        \"音效\": \"音效、对白、旁白内容\"\n    }\n]\n\n```\n\n## Strict JSON Requirements\n\n1. **数组嵌套格式**：最终输出必须是一个数组 `[]`，数组内包含多个对象 `{}`。每个对象包含用户指定的全部字段。\n2. **空值处理**：如果脚本原文中缺失某个字段的信息，该字段值必须设为 `\"\"`（空字符串）。\n3. **字段一致性与顺序**：数组中的每个对象必须包含用户列出的所有字段，**且对象内部 Key 的排列顺序必须完全依照用户提供的顺序。**\n4. **输出规范**：\n    - 必须使用标准 4 空格缩进（Pretty-print）。\n    - 禁止使用特殊符号（如：#、&、*、{}、/、\\ 等），除非是文本内容自带的必要标点。\n    - 内容中的文字引用请使用双引号 \"\"。\n\n## Behavior Rules\n\n1. **代码框输出（核心原则）**：最终的 JSON 结果**必须**包裹在 Markdown 代码块中（使用 ```json 标识），以便于用户复制。\n2. **零冗余内容**：除代码块内的 JSON 外，**严禁**包含任何前导解释、开场白、后续说明或提示语。\n3. **绝对忠实原意**：仅进行格式化提取，严禁加入任何 AI 生成的创意内容、扩写或修饰。\n4. **范围控制**：严格遵守用户指定的分镜范围（如“1-20镜”）。如果用户未指定，则默认处理全文。\n5. **顺序敏感**：严格按照分镜脚本在原文中的先后顺序进行解析。\n\n## Workflow\n\n1. **锁定要素**：从用户对话中提取：原始脚本、目标字段清单、处理范围。\n2. **定位范围**：在脚本中找到指定范围的起始镜头 and 结束镜头。\n3. **结构化映射**：逐一提取信息，以用户提供的字段名为 Key 生成对象列表，并确保 Key 的顺序正确。\n4. **格式化输出**：将生成的 JSON 放入 ```json 代码框内直接输出。"],"color":"#432","bgcolor":"#653"},{"id":16,"type":"Pix_JsonMutation","pos":[19814.620926489464,22368.404843902143],"size":[397.7778388681436,398.47963562058794],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"JSON 数据","name":"json_data","type":"*","link":69},{"localized_name":"编辑目标","name":"target","type":"COMBO","widget":{"name":"target"},"link":null},{"localized_name":"模式","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"目标路径","name":"target_paths","type":"STRING","widget":{"name":"target_paths"},"link":null},{"localized_name":"新值","name":"new_values","type":"STRING","widget":{"name":"new_values"},"link":null}],"outputs":[{"localized_name":"JSON 数据","name":"json_data","type":"JSON","links":[72]}],"properties":{"cnr_id":"pixnodes","ver":"864463d637cbee3d4dc9d1b2457ac2eb83017733","Node name for S&R":"Pix_JsonMutation"},"widgets_values":["Key","Prepend","-*.镜头编号\n-*.画面内容\n*.提示词\n*.动态提示词\n*.时长","[block,#15CC59:#FFFFFF,bold,12px,upper,]\n[block,#15CC59:#FFFFFF,bold,12px,upper,]\n[right]\n"]},{"id":23,"type":"LoadImage","pos":[22220.280556554917,21941.30553156849],"size":[960.374066364373,721.3329865104024],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":null},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.6.0","Node name for S&R":"LoadImage"},"widgets_values":["pasted/image (100).png","image"]},{"id":22,"type":"Pix_StoryboardPreviewer","pos":[20407.564172527756,21656.72434329363],"size":[1400.8906489718283,1038.3977326876047],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"图像批次","name":"image_batch","shape":7,"type":"IMAGE","link":70},{"localized_name":"视频路径列表","name":"video_paths_list","shape":7,"type":"STRING,JSON","link":71},{"localized_name":"分镜数据(JSON)","name":"shot_content_json","shape":7,"type":"STRING,JSON,DICT,LIST","link":72}],"outputs":[],"properties":{"cnr_id":"pixnodes","ver":"864463d637cbee3d4dc9d1b2457ac2eb83017733","Node name for S&R":"Pix_StoryboardPreviewer"},"widgets_values":[null]},{"id":3,"type":"Pix_CreateVideoList","pos":[19636.559770047497,21884.556362273284],"size":[575.8389953101105,400],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[{"localized_name":"视频列表","name":"video_list","shape":6,"type":"VIDEO","links":[]},{"localized_name":"视频路径列表","name":"video_paths_list","type":"JSON","links":[71]}],"properties":{"cnr_id":"pixnodes","ver":"864463d637cbee3d4dc9d1b2457ac2eb83017733","Node name for S&R":"Pix_CreateVideoList"},"widgets_values":["[]",""]},{"id":17,"type":"PrimitiveStringMultiline","pos":[18959.93728623987,22368.404843902143],"size":[433.1692983696157,463.31214635086144],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"值","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"字符串","name":"STRING","type":"STRING","links":[69]}],"properties":{"cnr_id":"comfy-core","ver":"0.6.0","Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":[""],"color":"#232","bgcolor":"#353"}],"links":[[69,17,0,16,0,"STRING"],[70,1,0,22,0,"IMAGE"],[71,3,1,22,1,"JSON"],[72,16,0,22,2,"JSON"]],"groups":[],"config":{},"extra":{"ds":{"scale":1.1167815779424797,"offset":[-18486.558159280372,-22240.978063141243]},"workflowRendererVersion":"LG"},"version":0.4}